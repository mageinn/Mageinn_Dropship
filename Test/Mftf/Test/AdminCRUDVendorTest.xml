<?xml version="1.0" encoding="UTF-8"?>
<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="../../../../../../vendor/magento/magento2-functional-testing-framework/src/Magento/FunctionalTestingFramework/Test/etc/testSchema.xsd">
    <test name="AdminManageVendor">
        <annotations>
            <features value="Manage Vendor"/>
            <stories value="Create/Edit/Delete a Vendor via the Admin"/>
            <title value="You should be able to manage a Vendor in the admin back-end."/>
            <description value="You should be able to mange a Vendor in the admin back-end."/>
            <group value="iredeem"/>
            <group value="vendorManage"/>
        </annotations>
        <before>
            <actionGroup ref="LoginAsAdmin" stepKey="loginAsAdmin"/>
        </before>
        <after>
            <amOnPage url="admin/admin/auth/logout/" stepKey="amOnLogoutPage"/>
        </after>

        <!--#### CREATE ####-->
        <amOnPage url="{{VendorPageData.createUrl}}" stepKey="amOnVendorsPageCreate"/>
        <waitForPageLoad stepKey="waitCreatePageLoad"/>

        <!--Complete first page required fields and wrong email and try to save-->
        <fillField selector="{{AdminVendorBasicFieldSection.VendorName}}" userInput="{{VendorData.name}}" stepKey="enterVendorNameInvalid"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" userInput="{{VendorInvalidData.email}}" stepKey="enterVendorEmailInvalid"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorTelephone}}" userInput="{{VendorData.telephone}}" stepKey="enterVendorPhoneInvalid"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor5"/>
        <seeElement selector="{{AdminVendorMessagesSection.InvalidMessage}}" stepKey="assertCreationInvalid"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" userInput="{{VendorData.email}}" stepKey="enterVendorEmailValid"/>

        <!--Complete the rest of the required fields and add invalid crons-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorAddress}}" stepKey="clickOnAddVendorAddressInvalid"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBillingAddress}}" stepKey="clickOnAddVendorBillingAddressInvalid"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingStreet}}" userInput="{{VendorAddress.street}}" stepKey="enterBillingStreetInvalid"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingCity}}" userInput="{{VendorAddress.city}}" stepKey="enterBillingCityInvalid"/>
        <selectOption selector="{{AdminVendorAddressFieldSection.BillingCountry}}" userInput="{{VendorAddress.country}}" stepKey="selectBillingCountryInvalid"/>
        <scrollToTopOfPage stepKey="scrollToTopOfPage4"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchExport}}" stepKey="clickVendorBatchExportTabInvalid"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchExportTitle}}" stepKey="clickVendorBatchExportCollapsibleInvalid"/>
        <fillField selector="{{AdminVendorBatchExportSection.Schedule}}" userInput="{{VendorInvalidData.schedule}}" stepKey="addBatchExportScheduleInvalid"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor6"/>
        <seeElement selector="{{AdminVendorMessagesSection.InvalidMessage}}" stepKey="assertCreationInvalid2"/>
        <fillField selector="{{AdminVendorBatchExportSection.Schedule}}" userInput="{{VendorBatchExport.schedule}}" stepKey="addBatchExportScheduleValid"/>
        <scrollToTopOfPage stepKey="scrollToTopOfPage5"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchImport}}" stepKey="clickVendorBatchImportTabInvalid"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchImportTitle}}" stepKey="clickVendorBatchImportCollapsibleInvalid"/>
        <fillField selector="{{AdminVendorBatchImportSection.Schedule}}" userInput="{{VendorInvalidData.schedule}}" stepKey="addBatchImportScheduleInvalid"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor7"/>
        <seeElement selector="{{AdminVendorMessagesSection.InvalidMessage}}" stepKey="assertCreationInvalid3"/>
        <fillField selector="{{AdminVendorBatchImportSection.Schedule}}" userInput="{{VendorBatchImport.schedule}}" stepKey="addBatchImportSchedule"/>

        <!--Save with all fields complete-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor8"/>
        <seeElement selector="{{AdminVendorMessagesSection.SuccessMessage}}" stepKey="assertCreationSuccess"/>

        <!--#### EDIT ####-->
        <!--Go to saved vendor page to make sure it was created-->
        <click selector="{{AdminVendorGridSection.filters}}" stepKey="clickOnFilters"/>
        <fillField selector="{{AdminVendorGridSection.VendorName}}" userInput="{{VendorData.name}}" stepKey="filterVendorName"/>
        <fillField selector="{{AdminVendorGridSection.VendorEmail}}" userInput="{{VendorData.email}}" stepKey="filterVendorEmail"/>
        <click selector="{{AdminVendorGridSection.applyFilters}}" stepKey="clickApplyFiltersButton"/>
        <waitForAjaxLoad stepKey="waitForResults"/>
        <click selector="{{AdminVendorGridSection.firstRowEditLink}}" stepKey="editSavedVendor"/>
        <waitForPageLoad stepKey="waitEditPageLoad"/>

        <!--Change Vendor name-->
        <see selector="{{AdminVendorFormFieldsTitles.VendorTitle}}" userInput="{{VendorData.name}}" stepKey="checkVendorSaved"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorName}}" userInput="{{VendorEdit.name}}" stepKey="enterVendorName"/>

        <!--Change Admin user-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage1"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorAdminUsers}}" stepKey="clickVendorUsersTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorUsers}}" stepKey="clickVendorUsersCollapsible"/>
        <click selector="{{AdminVendorUsersSelectionSection.ResetFilter}}" stepKey="clickVendorUsersResetFilters"/>
        <waitForAjaxLoad stepKey="waitForResetFilterToEnd"/>
        <fillField selector="{{AdminVendorUsersSelectionSection.FilterUserName}}" userInput="{{VendorUsers.userFilter}}" stepKey="fillVendorAdminUserName"/>
        <click selector="{{AdminVendorUsersSelectionSection.Search}}" stepKey="clickVendorUsersSearch"/>
        <waitForAjaxLoad stepKey="waitForResetAdminSearch"/>
        <click selector="{{AdminVendorUsersSelectionSection.SelectFirstUser}}" stepKey="clickOnFirstUser"/>
        <!--Change export destination-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage2"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchExport}}" stepKey="clickVendorBatchExportTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchExportTitle}}" stepKey="clickVendorBatchExportCollapsible"/>
        <fillField selector="{{AdminVendorBatchExportSection.Destination}}" userInput="{{VendorEdit.destination}}" stepKey="addBatchExportDestination"/>
        <!--Change import destination-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage3"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchImport}}" stepKey="clickVendorBatchImportTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchImportTitle}}" stepKey="clickVendorBatchImportCollapsible"/>
        <fillField selector="{{AdminVendorBatchImportSection.SourceLocation}}" userInput="{{VendorEdit.source}}" stepKey="addBatchImportSource"/>
        <!--Save-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor1"/>
        <seeElement selector="{{AdminVendorMessagesSection.SuccessMessage}}" stepKey="assertEditSuccess"/>

        <!--#### DELETE ####-->
        <!--Select vendor-->
        <click selector="{{AdminVendorGridSection.filters}}" stepKey="clickOnFilters2"/>
        <fillField selector="{{AdminVendorGridSection.VendorName}}" userInput="{{VendorEdit.name}}" stepKey="filterVendorName2"/>
        <fillField selector="{{AdminVendorGridSection.VendorEmail}}" userInput="{{VendorData.email}}" stepKey="filterVendorEmail2"/>
        <click selector="{{AdminVendorGridSection.applyFilters}}" stepKey="clickApplyFiltersButton2"/>
        <waitForAjaxLoad stepKey="waitForResults2"/>
        <click selector="{{AdminVendorGridSection.firstRowEditLink}}" stepKey="selectVendor"/>

        <!--Delete vendor-->
        <click selector="{{AdminVendorFormActionsSection.DeleteVendor}}" stepKey="deleteVendor"/>
        <click selector="{{AdminVendorFormActionsSection.VendorDeleteConfirmOK}}" stepKey="confirmDelete"/>
        <seeElement selector="{{AdminVendorMessagesSection.SuccessMessage}}" stepKey="assertDeleteSuccess"/>
    </test>
</tests>
