<?xml version="1.0" encoding="UTF-8"?>

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="../../../../../../vendor/magento/magento2-functional-testing-framework/src/Magento/FunctionalTestingFramework/Test/etc/testSchema.xsd">
    <test name="AdminEditVendor">
        <annotations>
            <features value="Vendor Edit"/>
            <stories value="Edit a Vendor via the Admin"/>
            <title value="You should be able to edit a Vendor in the admin back-end."/>
            <description value="You should be able to edit a Vendor in the admin back-end."/>
            <group value="iredeem"/>
            <group value="vendor"/>
        </annotations>
        <before>
            <actionGroup ref="LoginAsAdmin" stepKey="loginAsAdminForVendor1"/>
        </before>

        <actionGroup ref="SelectCreatedVendors" stepKey="selectCreatedVendors"/>
        <!--Change name-->
        <waitForElementVisible selector="{{AdminVendorBasicFieldSection.VendorName}}" stepKey="waitForName"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorName}}" userInput="{{VendorEdit.name}}" stepKey="enterVendorName"/>
        <!--Change currency-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSettingsTab}}" stepKey="clickOnAddVendorSettingsTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorSettings}}" stepKey="clickOnAddVendorAddVendorSettings"/>
        <selectOption selector="{{AdminVendorSettingsSection.VendorCurrency}}" userInput="{{VendorEdit.currency}}" stepKey="selectVendorCurrencyOption"/>
        <!--Change Billing street-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorAddress}}" stepKey="clickOnAddVendorAddress"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBillingAddress}}" stepKey="clickOnAddVendorBillingAddress"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingStreet}}" userInput="{{VendorEdit.street}}" stepKey="enterBillingStreet"/>
        <!--Change Admin user-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage1"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorAdminUsers}}" stepKey="clickVendorUsersTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorUsers}}" stepKey="clickVendorUsersCollapsible"/>
        <click selector="{{AdminVendorUsersSelectionSection.ResetFilter}}" stepKey="clickVendorUsersResetFilters"/>
        <waitForAjaxLoad stepKey="waitForResetFilterToEnd"/>
        <fillField selector="{{AdminVendorUsersSelectionSection.FilterUserName}}" userInput="{{VendorUsers.userFilter}}" stepKey="fillVendorAdminUserName"/>
        <click selector="{{AdminVendorUsersSelectionSection.Search}}" stepKey="clickVendorUsersSearch"/>
        <waitForAjaxLoad stepKey="waitForResetAdminSearch"/>
        <click selector="{{AdminVendorUsersSelectionSection.SelectFirstUser}}" stepKey="clickOnFirstUser"/>
        <!--Change export destination-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage2"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchExport}}" stepKey="clickVendorBatchExportTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchExportTitle}}" stepKey="clickVendorBatchExportCollapsible"/>
        <fillField selector="{{AdminVendorBatchExportSection.Destination}}" userInput="{{VendorEdit.destination}}" stepKey="addBatchExportDestination"/>
        <!--Change import destination-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage3"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchImport}}" stepKey="clickVendorBatchImportTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchImportTitle}}" stepKey="clickVendorBatchImportCollapsible"/>
        <fillField selector="{{AdminVendorBatchImportSection.SourceLocation}}" userInput="{{VendorEdit.source}}" stepKey="addBatchImportSource"/>
        <!--Save-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor1"/>
        <seeElement selector="{{AdminVendorMessagesSection.SuccessMessage}}" stepKey="assertEditSuccess"/>
    </test>

    <test name="AdminEditVendorWithoutRequiredFields">
        <annotations>
            <features value="Vendor Edit"/>
            <stories value="Edit a Vendor via the Admin without required fields"/>
            <title value="Try to save vendor without a required field"/>
            <description value="Try to save vendor without a required field"/>
            <group value="iredeem"/>
            <group value="vendor"/>
        </annotations>
        <before>
            <actionGroup ref="LoginAsAdmin" stepKey="loginAsAdminForVendor1"/>
            <amOnPage url="{{AdminVendorPage.url}}" stepKey="amOnVendorsPageEdit"/>
        </before>

        <!--Unset filter if set-->
        <actionGroup ref="SelectCreatedVendors" stepKey="selectCreatedVendors"/>
        <!--Clear vendor basic data and try to save-->
        <waitForElementVisible selector="{{AdminVendorBasicFieldSection.VendorName}}" stepKey="waitForName"/>
        <clearField selector="{{AdminVendorBasicFieldSection.VendorName}}" stepKey="clearVendorName"/>
        <clearField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" stepKey="clearVendorEmail"/>
        <clearField selector="{{AdminVendorBasicFieldSection.VendorTelephone}}" stepKey="clearVendorTelephone"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor1"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertEditWithoutRequired1"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorName}}" userInput="{{VendorData.name}}" stepKey="enterVendorName"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor2"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertEditWithoutRequired2"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" userInput="{{VendorData.email}}" stepKey="enterVendorEmail"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor3"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertEditWithoutRequired3"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorTelephone}}" userInput="{{VendorData.telephone}}" stepKey="enterVendorTelephone"/>
        <!--Clear vendor billing address and try to save-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorAddress}}" stepKey="clickOnAddVendorAddress"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBillingAddress}}" stepKey="clickOnAddVendorBillingAddress"/>
        <clearField selector="{{AdminVendorAddressFieldSection.BillingStreet}}" stepKey="clearBillingStreet"/>
        <clearField selector="{{AdminVendorAddressFieldSection.BillingCity}}" stepKey="clearBillingCity"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor4"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertEditWithoutRequired4"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingStreet}}" userInput="{{VendorAddress.street}}" stepKey="enterBillingStreet"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor5"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertEditWithoutRequired5"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingCity}}" userInput="{{VendorAddress.city}}" stepKey="selectBillingCity"/>
        <!--Save vendor-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor6"/>
        <seeElement selector="{{AdminVendorMessagesSection.SuccessMessage}}" stepKey="assertEditSuccess"/>
    </test>

    <test name="AdminEditVendorWithFailedValidation">
        <annotations>
            <features value="Vendor Edit"/>
            <stories value="Edit a Vendor via the Admin with failed validations"/>
            <title value="Try to save vendor with failing validation"/>
            <description value="Try to save vendor with failing validation"/>
            <group value="iredeem"/>
            <group value="vendor"/>
        </annotations>
        <before>
            <actionGroup ref="LoginAsAdmin" stepKey="loginAsAdminForVendor1"/>
            <amOnPage url="{{AdminVendorPage.url}}" stepKey="amOnVendorsPageEdit"/>
        </before>

        <!--Unset filter if set-->
        <actionGroup ref="SelectCreatedVendors" stepKey="selectCreatedVendors"/>
        <!--Complete first page with wrong email and try to save-->
        <waitForElementVisible selector="{{AdminVendorBasicFieldSection.VendorName}}" stepKey="waitForName"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" userInput="{{VendorInvalidData.email}}" stepKey="enterVendorEmailInvalid"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor1"/>
        <seeElement selector="{{AdminVendorMessagesSection.InvalidMessage}}" stepKey="assertEditInvalid1"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" userInput="{{VendorData.email}}" stepKey="enterVendorEmailValid"/>
        <!--Add invalid crons-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage4"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchExport}}" stepKey="clickVendorBatchExportTabInvalid"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchExportTitle}}" stepKey="clickVendorBatchExportCollapsibleInvalid"/>
        <fillField selector="{{AdminVendorBatchExportSection.Schedule}}" userInput="{{VendorInvalidData.schedule}}" stepKey="addBatchExportScheduleInvalid"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSaveAndContinue}}" stepKey="saveVendor2"/>
        <seeElement selector="{{AdminVendorMessagesSection.InvalidMessage}}" stepKey="assertEditInvalid2"/>
        <fillField selector="{{AdminVendorBatchExportSection.Schedule}}" userInput="{{VendorBatchExport.schedule}}" stepKey="addBatchExportScheduleValid"/>
        <scrollToTopOfPage stepKey="scrollToTopOfPage5"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchImport}}" stepKey="clickVendorBatchImportTabInvalid"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchImportTitle}}" stepKey="clickVendorBatchImportCollapsibleInvalid"/>
        <fillField selector="{{AdminVendorBatchImportSection.Schedule}}" userInput="{{VendorInvalidData.schedule}}" stepKey="addBatchImportScheduleInvalid"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor3"/>
        <seeElement selector="{{AdminVendorMessagesSection.InvalidMessage}}" stepKey="assertEditInvalid3"/>
        <fillField selector="{{AdminVendorBatchImportSection.Schedule}}" userInput="{{VendorBatchImport.schedule}}" stepKey="addBatchImportSchedule"/>
        <!--Save with all fields complete-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSaveAndContinue}}" stepKey="saveVendor4"/>
        <seeElement selector="{{AdminVendorMessagesSection.SuccessMessage}}" stepKey="assertCreationSuccess"/>
        <seeElement selector="{{AdminVendorFormFieldsTitles.VendorTitle}}" stepKey="checkVendorTitle"/>
    </test>
</tests>