<?xml version="1.0" encoding="UTF-8"?>

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="../../../../../../vendor/magento/magento2-functional-testing-framework/src/Magento/FunctionalTestingFramework/Test/etc/testSchema.xsd">
    <test name="AdminCreateVendor">
        <annotations>
            <features value="Vendor Creation"/>
            <stories value="Create a Vendor via the Admin"/>
            <title value="You should be able to create a Vendor in the admin back-end."/>
            <description value="You should be able to create a Vendor in the admin back-end."/>
            <group value="mageinn"/>
            <group value="vendor"/>
        </annotations>
        <before>
            <actionGroup ref="LoginAsAdmin" stepKey="loginAsAdminForVendor1"/>
        </before>
        <after>
            <amOnPage url="admin/admin/auth/logout/" stepKey="amOnLogoutPage"/>
        </after>

        <!--Get to vendor page-->
        <click selector="{{AdminMenuTitlesSection.Sales}}" stepKey="clickAdminMenuSalesLink"/>
        <click selector="{{AdminMenuSalesSection.Vendors}}" stepKey="clickSalesMenuVendorsLink"/>
        <click selector="{{AdminVendorGridSection.AddVendorButton}}" stepKey="clickOnAddVendor"/>
        <!--Fill vendor basic data-->
        <waitForElementVisible selector="{{AdminVendorBasicFieldSection.VendorName}}" stepKey="waitForName"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorName}}" userInput="{{VendorData.name}}" stepKey="enterVendorName"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" userInput="{{VendorData.email}}" stepKey="enterVendorEmail"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorTelephone}}" userInput="{{VendorData.telephone}}" stepKey="enterVendorPhone"/>
        <!--Fill vendor settings-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSettingsTab}}" stepKey="clickOnAddVendorSettingsTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorSettings}}" stepKey="clickOnAddVendorAddVendorSettings"/>
        <selectOption selector="{{AdminVendorSettingsSection.VendorCurrency}}" userInput="{{VendorData.currency}}" stepKey="selectVendorCurrencyOption"/>
        <!--Fill vendor billing address-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorAddress}}" stepKey="clickOnAddVendorAddress"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBillingAddress}}" stepKey="clickOnAddVendorBillingAddress"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingStreet}}" userInput="{{VendorAddress.street}}" stepKey="enterBillingStreet"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingCity}}" userInput="{{VendorAddress.city}}" stepKey="enterBillingCity"/>
        <selectOption selector="{{AdminVendorAddressFieldSection.BillingCountry}}" userInput="{{VendorAddress.country}}" stepKey="selectBillingCountry"/>
        <!--Fill shipping address-->
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorShippingAddress}}" stepKey="clickOnAddVendorShippingAddress"/>
        <click selector="{{AdminVendorAddressFieldSection.SameAsBilling}}" stepKey="uncheckSameAsBilling"/>
        <fillField selector="{{AdminVendorAddressFieldSection.ShippingStreet}}" userInput="{{VendorAddress.street_shipping}}" stepKey="enterShippingStreet"/>
        <fillField selector="{{AdminVendorAddressFieldSection.ShippingCity}}" userInput="{{VendorAddress.city_shipping}}" stepKey="enterShippingCity"/>
        <selectOption selector="{{AdminVendorAddressFieldSection.ShippingCountry}}" userInput="{{VendorAddress.country_shipping}}" stepKey="selectShippingCountry"/>
        <!--Set vendor admin users-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage1"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorAdminUsers}}" stepKey="clickVendorUsersTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorUsers}}" stepKey="clickVendorUsersCollapsible"/>
        <click selector="{{AdminVendorUsersSelectionSection.ResetFilter}}" stepKey="clickVendorUsersResetFilters"/>
        <waitForAjaxLoad stepKey="waitForResetFilterToEnd"/>
        <fillField selector="{{AdminVendorUsersSelectionSection.FilterUserName}}" userInput="{{VendorUsers.userFilter}}" stepKey="fillVendorAdminUserName"/>
        <click selector="{{AdminVendorUsersSelectionSection.Search}}" stepKey="clickVendorUsersSearch"/>
        <waitForAjaxLoad stepKey="waitForResetAdminSearch"/>
        <click selector="{{AdminVendorUsersSelectionSection.SelectAllUsers}}" stepKey="clickSelectAllVendorUsers"/>
        <!--Set vendor batch Export-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage2"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchExport}}" stepKey="clickVendorBatchExportTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchExportTitle}}" stepKey="clickVendorBatchExportCollapsible"/>
        <click selector="{{AdminVendorBatchExportSection.IsEnabled}}" stepKey="enableVendorBatchExport"/>
        <selectOption selector="{{AdminVendorBatchExportSection.ShipmentStatusOnExport}}" userInput="{{VendorBatchExport.shipmentStatusOnExport}}" stepKey="setShipmentStatusOnExport"/>
        <fillField selector="{{AdminVendorBatchExportSection.Schedule}}" userInput="{{VendorBatchExport.schedule}}" stepKey="addBatchExportSchedule"/>
        <fillField selector="{{AdminVendorBatchExportSection.Destination}}" userInput="{{VendorBatchExport.destination}}" stepKey="addBatchExportDestination"/>
        <fillField selector="{{AdminVendorBatchExportSection.Headings}}" userInput="{{VendorBatchExport.headings}}" stepKey="addBatchExportHeading"/>
        <fillField selector="{{AdminVendorBatchExportSection.Values}}" userInput="{{VendorBatchExport.values}}" stepKey="addBatchExportValues"/>
        <!--Set batch Import-->
        <scrollToTopOfPage stepKey="scrollToTopOfPage3"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchImport}}" stepKey="clickVendorBatchImportTab"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchImportTitle}}" stepKey="clickVendorBatchImportCollapsible"/>
        <fillField selector="{{AdminVendorBatchImportSection.Schedule}}" userInput="{{VendorBatchImport.schedule}}" stepKey="addBatchImportSchedule"/>
        <fillField selector="{{AdminVendorBatchImportSection.SourceLocation}}" userInput="{{VendorBatchImport.source}}" stepKey="addBatchImportSource"/>
        <fillField selector="{{AdminVendorBatchImportSection.Values}}" userInput="{{VendorBatchImport.values}}" stepKey="addBatchImportValues"/>
        <fillField selector="{{AdminVendorBatchImportSection.Delimiter}}" userInput="{{VendorBatchImport.delimiter}}" stepKey="addBatchImportDelimiter"/>
        <!--Save-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor1"/>
        <seeElement selector="{{AdminVendorMessagesSection.SuccessMessage}}" stepKey="assertCreationSuccess"/>
        <!--Go to saved vendor page to make sure it was created-->
        <click selector="{{AdminVendorGridSection.filters}}" stepKey="clickOnFilters"/>
        <fillField selector="{{AdminVendorGridSection.VendorName}}" userInput="{{VendorData.name}}" stepKey="filterVendorName"/>
        <fillField selector="{{AdminVendorGridSection.VendorEmail}}" userInput="{{VendorData.email}}" stepKey="filterVendorEmail"/>
        <fillField selector="{{AdminVendorGridSection.VendorTelephone}}" userInput="{{VendorData.telephone}}" stepKey="filterVendorPhone"/>
        <click selector="{{AdminVendorGridSection.applyFilters}}" stepKey="clickApplyFiltersButton"/>
        <waitForAjaxLoad stepKey="waitForResults"/>
        <click selector="{{AdminVendorGridSection.firstRowEditLink}}" stepKey="editSavedVendor"/>
        <see selector="{{AdminVendorFormFieldsTitles.VendorTitle}}" userInput="{{VendorData.name}}" stepKey="checkVendorSaved"/>
    </test>

    <test name="AdminCreateVendorWithoutRequiredField">
        <annotations>
            <features value="Vendor Creation"/>
            <stories value="Create a Vendor via the Admin without a required field"/>
            <title value="Create a vendor with a required field missing"/>
            <description value="Create a vendor with a required field missing"/>
            <group value="mageinn"/>
            <group value="vendor"/>
        </annotations>
        <before>
            <actionGroup ref="LoginAsAdmin" stepKey="loginAsAdminForVendor2"/>
            <amOnPage url="{{AdminVendorPage.url}}" stepKey="amOnVendorsPageWithoutRequired"/>
        </before>
        <after>
            <amOnPage url="admin/admin/auth/logout/" stepKey="amOnLogoutPage"/>
        </after>

        <click selector="{{AdminVendorGridSection.AddVendorButton}}" stepKey="clickOnAddVendor2"/>
        <waitForElementVisible selector="{{AdminVendorBasicFieldSection.VendorName}}" stepKey="waitForName"/>
        <!--Try to save-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor1"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertCreationWithoutRequired1"/>
        <!--Complete visible required fields and try to save again-->
        <fillField selector="{{AdminVendorBasicFieldSection.VendorName}}" userInput="{{VendorData.name}}" stepKey="enterVendorNameWithoutRequired"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor2"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertCreationWithoutRequired2"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" userInput="{{VendorData.email}}" stepKey="enterVendorEmailWithoutRequired"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor3"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertCreationWithoutRequired3"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorTelephone}}" userInput="{{VendorData.telephone}}" stepKey="enterVendorPhoneWithoutRequired"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor4"/>
        <seeElement selector="{{AdminVendorMessagesSection.ErrorIcon}}" stepKey="assertCreationWithoutRequired4"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBillingAddress}}" stepKey="clickOnAddVendorBillingAddress"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertCreationWithoutRequired5"/>
        <!--Complete visible required fields, enable shipping address and try to save-->
        <fillField selector="{{AdminVendorAddressFieldSection.BillingStreet}}" userInput="{{VendorAddress.street}}" stepKey="enterBillingStreetWithoutRequired"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor6"/>
        <seeElement selector="{{AdminVendorMessagesSection.ErrorIcon}}" stepKey="assertCreationWithoutRequired6"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingCity}}" userInput="{{VendorAddress.city}}" stepKey="enterBillingCityWithoutRequired"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor7"/>
        <seeElement selector="{{AdminVendorMessagesSection.ErrorIcon}}" stepKey="assertCreationWithoutRequired7"/>
        <selectOption selector="{{AdminVendorAddressFieldSection.BillingCountry}}" userInput="{{VendorAddress.country}}" stepKey="selectBillingCountryWithoutRequired"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorShippingAddress}}" stepKey="clickOnAddVendorShippingAddressWithoutRequired"/>
        <click selector="{{AdminVendorAddressFieldSection.SameAsBilling}}" stepKey="uncheckSameAsBillingWithoutRequired"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor8"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertCreationWithoutRequired8"/>
        <fillField selector="{{AdminVendorAddressFieldSection.ShippingStreet}}" userInput="{{VendorAddress.street_shipping}}" stepKey="enterShippingStreet"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor9"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertCreationWithoutRequired9"/>
        <fillField selector="{{AdminVendorAddressFieldSection.ShippingCity}}" userInput="{{VendorAddress.city_shipping}}" stepKey="enterShippingCity"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor10"/>
        <seeElement selector="{{AdminVendorMessagesSection.RequiredMessage}}" stepKey="assertCreationWithoutRequired10"/>
        <selectOption selector="{{AdminVendorAddressFieldSection.ShippingCountry}}" userInput="{{VendorAddress.country_shipping}}" stepKey="selectShippingCountry"/>
        <!--Save with all fields complete-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor11"/>
        <seeElement selector="{{AdminVendorMessagesSection.SuccessMessage}}" stepKey="assertCreationSuccess"/>
    </test>

    <test name="AdminCreateVendorInvalidField">
        <annotations>
            <features value="Vendor Creation"/>
            <stories value="Create a Vendor via the Admin with invalid fields"/>
            <title value="Create a vendor with invalid fields"/>
            <description value="Create a vendor with invalid fields"/>
            <group value="mageinn"/>
            <group value="vendor"/>
        </annotations>
        <before>
            <actionGroup ref="LoginAsAdmin" stepKey="loginAsAdminForVendor3"/>
            <amOnPage url="{{AdminVendorPage.url}}" stepKey="amOnVendorsPageInvalid"/>
        </before>
        <after>
            <amOnPage url="admin/admin/auth/logout/" stepKey="amOnLogoutPage"/>
        </after>

        <click selector="{{AdminVendorGridSection.AddVendorButton}}" stepKey="clickOnAddVendor3"/>
        <!--Complete first page required fields and wrong email and try to save-->
        <waitForElementVisible selector="{{AdminVendorBasicFieldSection.VendorName}}" stepKey="waitForName"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorName}}" userInput="{{VendorData.name}}" stepKey="enterVendorNameInvalid"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" userInput="{{VendorInvalidData.email}}" stepKey="enterVendorEmailInvalid"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorTelephone}}" userInput="{{VendorData.telephone}}" stepKey="enterVendorPhoneInvalid"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor5"/>
        <seeElement selector="{{AdminVendorMessagesSection.InvalidMessage}}" stepKey="assertCreationInvalid"/>
        <fillField selector="{{AdminVendorBasicFieldSection.VendorEmail}}" userInput="{{VendorData.email}}" stepKey="enterVendorEmailValid"/>
        <!--Complete the rest of the required fields and add invalid crons-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorAddress}}" stepKey="clickOnAddVendorAddressInvalid"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBillingAddress}}" stepKey="clickOnAddVendorBillingAddressInvalid"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingStreet}}" userInput="{{VendorAddress.street}}" stepKey="enterBillingStreetInvalid"/>
        <fillField selector="{{AdminVendorAddressFieldSection.BillingCity}}" userInput="{{VendorAddress.city}}" stepKey="enterBillingCityInvalid"/>
        <selectOption selector="{{AdminVendorAddressFieldSection.BillingCountry}}" userInput="{{VendorAddress.country}}" stepKey="selectBillingCountryInvalid"/>
        <scrollToTopOfPage stepKey="scrollToTopOfPage4"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchExport}}" stepKey="clickVendorBatchExportTabInvalid"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchExportTitle}}" stepKey="clickVendorBatchExportCollapsibleInvalid"/>
        <fillField selector="{{AdminVendorBatchExportSection.Schedule}}" userInput="{{VendorInvalidData.schedule}}" stepKey="addBatchExportScheduleInvalid"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor6"/>
        <seeElement selector="{{AdminVendorMessagesSection.InvalidMessage}}" stepKey="assertCreationInvalid2"/>
        <fillField selector="{{AdminVendorBatchExportSection.Schedule}}" userInput="{{VendorBatchExport.schedule}}" stepKey="addBatchExportScheduleValid"/>
        <scrollToTopOfPage stepKey="scrollToTopOfPage5"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorBatchImport}}" stepKey="clickVendorBatchImportTabInvalid"/>
        <click selector="{{AdminVendorFormFieldsTitles.AddVendorBatchImportTitle}}" stepKey="clickVendorBatchImportCollapsibleInvalid"/>
        <fillField selector="{{AdminVendorBatchImportSection.Schedule}}" userInput="{{VendorInvalidData.schedule}}" stepKey="addBatchImportScheduleInvalid"/>
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor7"/>
        <seeElement selector="{{AdminVendorMessagesSection.InvalidMessage}}" stepKey="assertCreationInvalid3"/>
        <fillField selector="{{AdminVendorBatchImportSection.Schedule}}" userInput="{{VendorBatchImport.schedule}}" stepKey="addBatchImportSchedule"/>
        <!--Save with all fields complete-->
        <click selector="{{AdminVendorFormActionsSection.AddVendorSave}}" stepKey="saveVendor8"/>
        <seeElement selector="{{AdminVendorMessagesSection.SuccessMessage}}" stepKey="assertCreationSuccess"/>
    </test>
</tests>
